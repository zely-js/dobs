{"version":3,"file":"index.js","names":["__create","__defProp","__getOwnPropDesc","__getOwnPropNames","__getProtoOf","__hasOwnProp","__copyProps","__toESM","node_fs","node_path","defineRoutes"],"sources":["../../../../packages/dobs-http/dist/index.js","../../../../packages/dobs/dist/index.js","../../app/index.ts"],"sourcesContent":["Object.defineProperty(exports, '__esModule', { value: true });\n//#region rolldown:runtime\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __copyProps = (to, from, except, desc) => {\n\tif (from && typeof from === \"object\" || typeof from === \"function\") for (var keys = __getOwnPropNames(from), i = 0, n = keys.length, key; i < n; i++) {\n\t\tkey = keys[i];\n\t\tif (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {\n\t\t\tget: ((k) => from[k]).bind(null, key),\n\t\t\tenumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable\n\t\t});\n\t}\n\treturn to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", {\n\tvalue: mod,\n\tenumerable: true\n}) : target, mod));\n\n//#endregion\nlet node_http = require(\"node:http\");\nnode_http = __toESM(node_http);\nlet node_url = require(\"node:url\");\nnode_url = __toESM(node_url);\nlet encodeurl = require(\"encodeurl\");\nencodeurl = __toESM(encodeurl);\nlet mime_types = require(\"mime-types\");\nmime_types = __toESM(mime_types);\nlet node_fs = require(\"node:fs\");\nnode_fs = __toESM(node_fs);\nlet node_path = require(\"node:path\");\nnode_path = __toESM(node_path);\n\n//#region src/context.ts\nfunction createRequest(req) {\n\tconst request = req;\n\tconst url = new node_url.URL(request.url, `http://${request.headers.host || \"localhost\"}`);\n\tconst _body = req._body;\n\trequest.pathname = url.pathname;\n\trequest.href = url.href;\n\trequest.search = url.searchParams;\n\trequest.searchString = url.search;\n\trequest.query = Object.fromEntries(url.searchParams);\n\trequest.URL = url;\n\trequest.rawBody = _body;\n\treturn request;\n}\nfunction createResponse(res) {\n\tconst response = res;\n\tresponse.status = (code) => {\n\t\tresponse.statusCode = code;\n\t\treturn response;\n\t};\n\tresponse.message = (message) => {\n\t\tresponse.statusMessage = message;\n\t\treturn response;\n\t};\n\tresponse.set = (field, value) => {\n\t\tif (typeof field === \"string\") response.setHeader(field, value);\n\t\telse Object.keys(field).forEach((header) => response.setHeader(header, field[header]));\n\t\treturn this;\n\t};\n\tresponse.get = (field) => {\n\t\treturn response.getHeader(field);\n\t};\n\tresponse.remove = (field) => {\n\t\tresponse.removeHeader(field);\n\t\treturn response;\n\t};\n\tresponse.has = (field) => {\n\t\treturn response.hasHeader(field);\n\t};\n\tresponse.redirect = (url) => {\n\t\tif (/^https?:\\/\\//i.test(url)) url = new node_url.URL(url).toString();\n\t\tresponse.set(\"Location\", (0, encodeurl.default)(url));\n\t\tresponse.status(302);\n\t\tresponse.end();\n\t\treturn response;\n\t};\n\tresponse.type = (type) => {\n\t\tconst mimeType = (0, mime_types.contentType)(type);\n\t\tif (mimeType) response.set(\"Content-Type\", mimeType);\n\t\telse response.remove(\"Content-Type\");\n\t\treturn response;\n\t};\n\tresponse.isWritable = () => {\n\t\tif (response.writableEnded || response.finished) return false;\n\t\tconst socket = response.socket;\n\t\tif (!socket) return true;\n\t\treturn socket.writable;\n\t};\n\tresponse.send = (data) => {\n\t\tlet body;\n\t\tif (Buffer.isBuffer(data)) body = data;\n\t\telse if (typeof data === \"string\") body = data;\n\t\telse if (data === null || data === void 0) body = \"\";\n\t\telse if (typeof data === \"object\" || Array.isArray(data)) {\n\t\t\tresponse.type(\"json\");\n\t\t\tbody = JSON.stringify(data);\n\t\t} else if (typeof data === \"number\" || typeof data === \"boolean\") body = String(data);\n\t\telse body = String(data);\n\t\tif (!response.has(\"Content-Length\")) response.set(\"Content-Length\", Buffer.byteLength(body));\n\t\tresponse.end(body);\n\t};\n\tresponse.text = (data) => {\n\t\tresponse.type(\"text\").send(data);\n\t};\n\tresponse.json = (data) => {\n\t\tresponse.type(\"json\").send(JSON.stringify(data));\n\t};\n\tresponse.html = (data) => {\n\t\tresponse.type(\"html\").send(data);\n\t};\n\tresponse.sendFile = (file) => {\n\t\tconst stat = (0, node_fs.statSync)(file);\n\t\tresponse.status(200);\n\t\tresponse.type((0, node_path.extname)(file));\n\t\tresponse.set(\"Content-Length\", stat.size);\n\t\t(0, node_fs.createReadStream)(file).pipe(response);\n\t};\n\treturn response;\n}\n\n//#endregion\n//#region src/index.ts\nfunction getBody(req) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet body = \"\";\n\t\treq.on(\"data\", (chunk) => {\n\t\t\tbody += chunk.toString();\n\t\t});\n\t\treq.on(\"end\", () => resolve(body));\n\t\treq.on(\"error\", reject);\n\t});\n}\nvar BaseServer = class {\n\tmiddlewares;\n\tserver;\n\ton;\n\toff;\n\tonce;\n\taddListener;\n\tremoveListener;\n\tremoveAllListeners;\n\temit;\n\tlisteners;\n\tlistenerCount;\n\tlisten;\n\tconstructor(cs = node_http.createServer) {\n\t\tthis.middlewares = [];\n\t\tthis.server = cs(this.handle.bind(this));\n\t\tthis.on = this.server.on.bind(this.server);\n\t\tthis.off = this.server.off.bind(this.server);\n\t\tthis.once = this.server.once.bind(this.server);\n\t\tthis.addListener = this.server.addListener.bind(this.server);\n\t\tthis.removeListener = this.server.removeListener.bind(this.server);\n\t\tthis.removeAllListeners = this.server.removeAllListeners.bind(this.server);\n\t\tthis.emit = this.server.emit.bind(this.server);\n\t\tthis.listeners = this.server.listeners.bind(this.server);\n\t\tthis.listenerCount = this.server.listenerCount.bind(this.server);\n\t\tthis.listen = this.server.listen.bind(this.server);\n\t}\n\t/**\n\t* append middlewares\n\t* ```ts\n\t* app.use(middleware);\n\t* ```\n\t* @param middlewares Middlewares\n\t*/\n\tuse(...middlewares) {\n\t\tmiddlewares.forEach((middleware) => {\n\t\t\tif (typeof middleware !== \"function\") {} else this.middlewares.push(middleware);\n\t\t});\n\t\treturn this;\n\t}\n\thandle(req, res) {\n\t\tif (this.middlewares.length === 0) {\n\t\t\tres.statusCode = 404;\n\t\t\tres.end();\n\t\t}\n\t\tlet index = -1;\n\t\tconst request = createRequest(req);\n\t\tconst response = createResponse(res);\n\t\tconst loop = async () => {\n\t\t\tif (index < this.middlewares.length && !res.writableEnded) {\n\t\t\t\tconst middleware = this.middlewares[index += 1];\n\t\t\t\tif (middleware) {\n\t\t\t\t\tlet called = false;\n\t\t\t\t\tconst next = async () => {\n\t\t\t\t\t\tif (called) throw new Error(\"next() called multiple times\");\n\t\t\t\t\t\tcalled = true;\n\t\t\t\t\t\tawait loop();\n\t\t\t\t\t};\n\t\t\t\t\tawait middleware(request, response, next);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tgetBody(req).then((body) => {\n\t\t\trequest._body = body;\n\t\t\tloop();\n\t\t});\n\t}\n};\nfunction app(cs = node_http.createServer) {\n\treturn new BaseServer(cs);\n}\nvar src_default = app;\n\n//#endregion\nexports.BaseServer = BaseServer;\nexports.createRequest = createRequest;\nexports.createResponse = createResponse;\nexports.default = src_default;","//#region rolldown:runtime\nvar __create = Object.create;\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __getProtoOf = Object.getPrototypeOf;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __copyProps = (to, from, except, desc) => {\n\tif (from && typeof from === \"object\" || typeof from === \"function\") for (var keys = __getOwnPropNames(from), i = 0, n = keys.length, key; i < n; i++) {\n\t\tkey = keys[i];\n\t\tif (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {\n\t\t\tget: ((k) => from[k]).bind(null, key),\n\t\t\tenumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable\n\t\t});\n\t}\n\treturn to;\n};\nvar __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(isNodeMode || !mod || !mod.__esModule ? __defProp(target, \"default\", {\n\tvalue: mod,\n\tenumerable: true\n}) : target, mod));\n\n//#endregion\nlet __dobsjs_http = require(\"@dobsjs/http\");\n__dobsjs_http = __toESM(__dobsjs_http);\nlet deepmerge_ts = require(\"deepmerge-ts\");\ndeepmerge_ts = __toESM(deepmerge_ts);\nlet node_path = require(\"node:path\");\nnode_path = __toESM(node_path);\nlet rolldown = require(\"rolldown\");\nrolldown = __toESM(rolldown);\nlet chokidar = require(\"chokidar\");\nchokidar = __toESM(chokidar);\nlet chalk = require(\"chalk\");\nchalk = __toESM(chalk);\nlet node_fs = require(\"node:fs\");\nnode_fs = __toESM(node_fs);\nlet node_module = require(\"node:module\");\nnode_module = __toESM(node_module);\n\n//#region src/config.ts\nconst DEFAULT_CONFIG = {\n\tport: 8080,\n\tmiddlewares: [],\n\tcreateServer: void 0,\n\tcwd: process.cwd(),\n\tmode: \"serve\",\n\ttemp: \"./.dobs/\"\n};\nfunction resolveConfig(config) {\n\treturn (0, deepmerge_ts.deepmerge)(DEFAULT_CONFIG, config);\n}\n\n//#endregion\n//#region src/shared/fs.ts\n/**\n* @returns Absolute paths (with unnormalized)\n*/\nfunction scanDirectory(directoryPath, fileList = []) {\n\tnode_fs.readdirSync(directoryPath).forEach((item) => {\n\t\tconst fullPath = node_path.join(directoryPath, item);\n\t\tif (node_fs.statSync(fullPath).isDirectory()) scanDirectory(fullPath, fileList);\n\t\telse fileList.push(fullPath);\n\t});\n\treturn fileList;\n}\n\n//#endregion\n//#region src/shared/urlPath.ts\nfunction convertPathToRegex(path) {\n\tconst params = [];\n\tlet processedPath = path;\n\tconst ext = (0, node_path.extname)(processedPath);\n\tif (ext) processedPath = processedPath.slice(0, -ext.length);\n\tif (processedPath.endsWith(\"index\")) processedPath = processedPath.slice(0, -5);\n\tconst regexString = `^/${processedPath.split(\"/\").filter((part) => part !== \"\").map((part) => {\n\t\tif (part.startsWith(\"[...\") && part.endsWith(\"]\")) {\n\t\t\tconst paramName = part.slice(1, -1);\n\t\t\tparams.push(paramName);\n\t\t\treturn \"(.*)\";\n\t\t}\n\t\tif (part.startsWith(\"[\") && part.endsWith(\"]\")) {\n\t\t\tconst paramName = part.slice(1, -1);\n\t\t\tparams.push(paramName);\n\t\t\treturn \"([^/]+)\";\n\t\t}\n\t\treturn part.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n\t}).join(\"/\")}/?$`;\n\treturn {\n\t\tregex: new RegExp(regexString),\n\t\tparams\n\t};\n}\n\n//#endregion\n//#region src/shared/path.ts\n/** changeExtension(\"/a/b/c.ts\", \".tsx\") */\nfunction changeExtension(filename, to) {\n\tconst { dir, name } = (0, node_path.parse)(filename);\n\treturn (0, node_path.join)(dir, name + to).replace(/\\\\/g, \"/\");\n}\nfunction isSamePath(pathA, pathB, cwd = process.cwd()) {\n\tconst normalizedA = (0, node_path.normalize)((0, node_path.resolve)(cwd, pathA));\n\tconst normalizedB = (0, node_path.normalize)((0, node_path.resolve)(cwd, pathB));\n\tif (process.platform === \"win32\") return normalizedA.toLowerCase() === normalizedB.toLowerCase();\n\treturn normalizedA === normalizedB;\n}\n\n//#endregion\n//#region src/shared/object.ts\nfunction lowercaseKeyObject(obj) {\n\treturn Object.fromEntries(Object.entries(obj).map(([k, v]) => [k.toLowerCase(), v]));\n}\n\n//#endregion\n//#region src/server/load.ts\nconst require$1 = (0, node_module.createRequire)(require(\"url\").pathToFileURL(__filename).href);\nasync function dynamicImport(filePath) {\n\ttry {\n\t\tconst resolved = require$1.resolve(filePath);\n\t\tif (require$1.cache[resolved]) delete require$1.cache[resolved];\n\t\tconst exports$1 = require$1(filePath);\n\t\treturn exports$1 && exports$1.__esModule && exports$1.default ? exports$1.default : exports$1;\n\t} catch (e) {\n\t\tconsole.error(\"Failed to require:\", filePath, e);\n\t\tthrow e;\n\t}\n}\n\n//#endregion\n//#region src/server/plugins/external.ts\n/**\n* Rolldown plugin for exclude node_modules from bundle\n*/\nfunction nodeExternal(options = {}) {\n\tconst { allow = [] } = options;\n\tconst allowSet = new Set(allow);\n\treturn {\n\t\tname: \"dobs:exclude-node-modules\",\n\t\tasync resolveId(source, importer) {\n\t\t\tif (!importer) return null;\n\t\t\tif (source.startsWith(\"\\0\")) return null;\n\t\t\tif (allowSet.has(source)) return null;\n\t\t\tif (source.startsWith(\".\") || source.startsWith(\"/\")) return null;\n\t\t\tconst resolved = await this.resolve(source, importer, { skipSelf: true }).catch(() => null);\n\t\t\tif (resolved && resolved.id) {\n\t\t\t\tif (resolved.id.includes(\"node_modules\")) return {\n\t\t\t\t\tid: source,\n\t\t\t\t\texternal: true\n\t\t\t\t};\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tid: source,\n\t\t\t\texternal: true\n\t\t\t};\n\t\t}\n\t};\n}\n\n//#endregion\n//#region src/server/router.ts\nfunction routeScore(route) {\n\tlet score = 0;\n\tfor (const param of route.params) if (param.startsWith(\"...\")) score += 999;\n\telse score += 1;\n\treturn score;\n}\n/**\n* Create routes by filename and sort it by params length\n*/\nfunction createRoutes(config) {\n\tconst routesDirectory = (0, node_path.join)(config.cwd, \"app\");\n\treturn scanDirectory(routesDirectory).map((file) => (0, node_path.relative)(routesDirectory, file)).map((file) => {\n\t\tfile = file.replace(/\\\\/g, \"/\");\n\t\tif (file.startsWith(\".\")) file = file.slice(1);\n\t\tif (file.startsWith(\"/\")) file = file.slice(1);\n\t\treturn {\n\t\t\t...convertPathToRegex(file),\n\t\t\trelativePath: file\n\t\t};\n\t}).sort((a, b) => routeScore(a) - routeScore(b));\n}\nasync function createRouterMiddleware(config) {\n\tconst routesDirectory = (0, node_path.join)(config.cwd, \"app\");\n\tconst tempDirectory = (0, node_path.join)(config.cwd, config.temp, \"routes\");\n\tconst cachedModule = /* @__PURE__ */ new Map();\n\tconst matchRoute = (url) => routes.find((route) => route.regex.test(url));\n\tconst buildOption = () => ({\n\t\tinput: routes.map((route) => (0, node_path.join)(routesDirectory, route.relativePath)),\n\t\toutput: {\n\t\t\tformat: \"cjs\",\n\t\t\tsourcemap: true,\n\t\t\tesModule: true,\n\t\t\tdir: tempDirectory\n\t\t},\n\t\tplugins: [nodeExternal()]\n\t});\n\tlet routes = createRoutes(config);\n\tawait (0, rolldown.build)(buildOption());\n\tif (process.env.NODE_ENV === \"development\") chokidar.default.watch(routesDirectory, {\n\t\tignoreInitial: true,\n\t\tcwd: config.cwd\n\t}).on(\"all\", async (evt, path) => {\n\t\troutes = createRoutes(config);\n\t\tawait (0, rolldown.build)(buildOption());\n\t\tconst matchedPage = Array.from(cachedModule.keys()).find((key) => isSamePath((0, node_path.join)(routesDirectory, key), path, config.cwd));\n\t\tif (matchedPage) cachedModule.delete(matchedPage);\n\t\tconsole.log(`${chalk.default.blue(\"info\")} server updated. ${chalk.default.gray.dim(`(${path})`.replace(/\\\\/g, \"/\"))}`);\n\t});\n\treturn async (req, res, next) => {\n\t\tconst url = req.URL.pathname;\n\t\tconst route = matchRoute(url);\n\t\tif (!route) return next();\n\t\tif (!cachedModule.has(route.relativePath)) cachedModule.set(route.relativePath, await dynamicImport(changeExtension((0, node_path.join)(tempDirectory, route.relativePath), \".js\")));\n\t\tconst pageModule = cachedModule.get(route.relativePath);\n\t\ttry {\n\t\t\tconst method = (req.method || \"\").toLocaleLowerCase();\n\t\t\tconst handlers = pageModule;\n\t\t\tconst execute = async (handler) => {\n\t\t\t\tif (typeof handler !== \"function\") return res.send(handler);\n\t\t\t\tconst response = await handler(req, res);\n\t\t\t\tif (!res.isWritable() && response) res.send(response);\n\t\t\t};\n\t\t\tif (typeof handlers === \"function\") return execute(handlers);\n\t\t\tconst handlerObject = lowercaseKeyObject(handlers);\n\t\t\tif (handlerObject.all) execute(handlerObject.all);\n\t\t\tif (handlerObject[method]) execute(handlerObject[method]);\n\t\t} catch (e) {\n\t\t\tconsole.error(e);\n\t\t}\n\t};\n}\n\n//#endregion\n//#region src/server/index.ts\nasync function createDobsServer(config) {\n\tconst resolvedConfig = resolveConfig(config);\n\tconst server = (0, __dobsjs_http.default)(resolvedConfig.createServer);\n\tserver.middlewares.push(...resolvedConfig.middlewares);\n\tserver.middlewares.push(await createRouterMiddleware(resolvedConfig));\n\tif (resolvedConfig.mode === \"middleware\") return server.middlewares;\n\treturn server.listen(resolvedConfig.port, () => {});\n}\n\n//#endregion\n//#region src/types.ts\n/**\n* Define route object.\n*\n* ```ts\n* export default defineRoutes({\n*    GET(req, res) { ... }, // dynamic handler\n*    POST: { message: \"hello world\" } // static handler\n* });\n* ```\n*\n* @param routes routes object.\n*/\nfunction defineRoutes(routes) {\n\treturn routes;\n}\nfunction defineConfig(userConfig) {\n\treturn userConfig;\n}\n\n//#endregion\nexports.DEFAULT_CONFIG = DEFAULT_CONFIG;\nexports.createDobsServer = createDobsServer;\nexports.defineConfig = defineConfig;\nexports.defineRoutes = defineRoutes;\nexports.resolveConfig = resolveConfig;","import { defineRoutes } from 'dobs';\n\nexport default defineRoutes({\n  GET(req, res) {\n    res.send('Dynamic Handler');\n  },\n  POST: { message: 'This is static data' },\n});\n"],"mappings":"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"}